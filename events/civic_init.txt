namespace = dragon_start

### Empire init - add technologies and resources
country_event = {
	id = dragon_start.360
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { 
			limit = { 
				has_civic = civic_dragon_init
			}
			give_technology = { message = no tech = tech_robotic_workers }
			add_minerals = 200 #start with 200 by default
		}
	}
}

planet_event = { #replace slums
	id = dragon_start.300
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { limit = { owner = { has_valid_civic = civic_dragon_init } }
			while = {
				count = 1
				random_tile = {
					limit = {
						has_blocker = tb_failing_infrastructure
					}
					set_blocker = tb_meteor_crater
				}
			}
			every_tile = {
				limit = {
					has_blocker = tb_decrepit_dwellings
				}
				prev = { 
					set_planet_flag = tb_animals_at@prev
				}	
				set_blocker = tb_animal_yard
			}
		}
	}
}

planet_event = { #replace farms
	id = dragon_start.301
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { limit = { owner = { has_country_flag = aleran } }
			every_tile = {
				limit = {
					has_building = building_hydroponics_farm_1
				}
				set_building = building_meat_lab_1
			}
		}
	}
}

planet_event = {
	id = dragon_start.361
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { limit = { owner = { has_valid_civic = civic_dragon_init } }
			while = {
				count = 1
				random_tile = {
					limit = {
						OR = {
							has_building = building_mining_network_1
							AND = {
								has_building = no
								has_blocker = no
								has_resource = { type = energy amount < 1 } 
								has_resource = { type = food amount < 1 } 
								has_resource = { type = physics_research amount < 1 } 
								has_resource = { type = society_research amount < 1 } 
								has_resource = { type = engineering_research amount < 1 } 
							}
						}
						has_pop = no
					}
					build_pop = {
						name = buildable_robot_pop_1
					}
					set_building = building_mining_network_1
				}
			}
		}
	}
}

country_event = {
	id = dragon_start.350
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { 
			limit = { 
				has_civic = civic_dragon_init
				is_ai = yes
			}
			add_modifier = {
				modifier = "aleran_ai_bonus"
				days = -1
			}
		}
	}
}

country_event = {
	id = dragon_start.362
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { 
			limit = { 
				has_civic = civic_dragon_init
			}
			country_government_civic_points_add = 1
			change_government = {
				authority = auth_dragon
				civics = {
					civic = civic_dragon_gov
					civic = civic_dragon_tech
					civic = civic_dragon_research
				}
			} 
		}
	}
}

country_event = {
	id = dragon_start.363
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { 
			limit = { 
				has_civic = civic_dragon_gov
			}
			#change leader traits
			FROMFROM = {
				leader = {
					remove_trait = trait_ruler_warlike
					remove_trait = trait_ruler_corvette_focus
					remove_trait = trait_ruler_destroyer_focus
					remove_trait = trait_ruler_cruiser_focus
					remove_trait = trait_ruler_battleship_focus
					remove_trait = trait_ruler_recruiter
					remove_trait = trait_ruler_from_the_ranks
					remove_trait = trait_ruler_fortifier
					remove_trait = trait_ruler_logistic_understanding
					remove_trait = trait_ruler_military_pioneer
					add_trait = trait_ruler_expansionist
					add_trait = trait_ruler_frontier_spirit
					add_trait = trait_ruler_space_miner
					set_age = 29
				}
			}		
		}
	}
}

event = {
	id = dragon_start.364
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = { exists = capital_scope has_civic = civic_dragon_init }
			capital_scope = {
				solar_system = {
					every_system_planet = {
						if = {
							limit = { #Evek
								is_planet_class = pc_molten
								is_moon = no
							}
							add_modifier = {
								modifier = "extreme_storms"
								days = -1
							}
						}
					}
				}
			}
		}
	}
}

country_event = {
	id = dragon_start.365
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = { 
			limit = { 
				has_civic = civic_dragon_gov
			}
			set_policy = { policy = slavery option = slavery_not_allowed cooldown = no }
			set_policy = { policy = purge option = purge_not_allowed cooldown = no }
			set_policy = { policy = pre_sapients option = pre_sapients_protect cooldown = no }
			set_policy = { policy = artificial_intelligence_policy option = ai_servitude cooldown = no }
			set_policy = { policy = first_contact_protocol option = first_contact_attack_not_allowed cooldown = no }
			set_policy = { policy = resettlement option = resettlement_allowed cooldown = no }
			set_policy = { policy = enlightenment option = enlightenment_allowed cooldown = no }
			set_policy = { policy = orbital_bombardment option = orbital_bombardment_selective cooldown = no }
		}
	}
}